# 폼 : HTML form과 react hook form

상태 : accepted

## 역사

### 2024년 11월 8일 탐정토끼가 일단 react-hook-form을 들여옴

## 맥락과 이유

HTML form은 훌륭하지만 유려한 에러와 에러 메세지 처리를 비롯해 여러 기능을 구현하기에는 까다롭습니다. schema와 같이 사용하기도 쉽지 않고요. 물론 현대적인 라이브러리와 astro component를 이용하면 어느 정도 이런 단점을 상쇄할 수 있지만. 조금 번들 용량을 키워서라도, 클라이언트에서 검증을 하고 서버에서 검증할 일을 줄이고 싶습니다.

그렇다고 라이브러리 없이 리액트 useState를 그대로 쓰자니, 귀찮은 건 둘째치고 성능이 문제입니다. 리액트 모델은 한 글자를 칠 때마다 모든 폼이 리렌더되는 실수를 하기 쉽습니다. 이런 실수를 하는 사람을 벌써 몇 번이나 봤는지 모릅니다.

물론 각 필드의 지역 상태를 만들고, 폼을 제출할 때에만 formData로 수집하는 방법도 있습니다만. error 상태를 다시 밑으로 내려준다거나, 사용자가 값을 수정하면 다음 제출할 때까지 error 가 안 보이게 하는 등의 UX를 구현하기는 좀 어렵습니다.

저는 회사에서 final-form을 쓰고 있는데, typescript 지원이 그렇게 훌륭하진 않습니다.

@tanstack/form 은 typescript 지원이 잘 되어 있지만, 아직 1.0도 나오지 않았고요. 기능이 강력한 만큼 사용법이 복잡한 면이 없지 않습니다.

## 결정

역사와 전통이 있는 react-hook-form을 선택합니다. valibot 같은 저희 스키마 라이브러리의 resolver도 제공하며, 타입스크립트 지원도 잘 됩니다. controller 등을 이용하면 선언적인 필드 컴포넌트도 쉽게 만들 수 있습니다.

## 유보

react-hook-form을 쓰더라도 라이브러리의 구현을 노출하지 않으려 합니다. shared/form에서만 react-hook-form을 사용해서 감싸고, 나중에 갈아타는 경우에도 shared/form 만 이사를 가면 되도록 하려 합니다.